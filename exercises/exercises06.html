<!DOCTYPE html>

<html>
	<head>
		<meta charset="UTF-8">
		<title>自定义指令 - Vue Test</title>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vue"></script>
	</head>
	
	<body>
		<div id="app">
			<div v-if="isExist" v-my-directive="param"></div>
		</div>
		
		<script type="text/javascript">			
			/**
			 * 数据驱动：通过指令（directive）把数据变化映射为DOM行为，即封装对DOM元素的重复处理行为。
			 * 内置指令：v-bind v-model v-on v-if/v-else/v-show v-for v-text v-HTML v-el v-ref v-pre v-cloak v-once
			 * 自定义指令：
			 * 通过Vue.directive()定义全局指令
			 * 在组件内使用directives属性定义局部指令，只能被当前组件调用
			 * 指令定义对象的钩子函数：bind update unbind
			 * 指令实例属性：
			 * el: 指令绑定的元素
			 * vm: 指令的上下文ViewModel，可以为Vue的实例，也可以为组件的实例
			 * name:　指令的名称
			 * arg: 指令的参数
			 * expression: 指令的表达式，不包括参数和过滤器
			 * modifiers: 对象，包含指令的修饰符
			 * descriptor: 对象，包含指令的解析结果
			 */
			
			//注册指令
			Vue.directive("my-directive", {
				bind: function() {
					console.log("bind ...");
				},
				update: function(newVal, oldVal) {
					console.log("update: ", oldVal, " -> ", newVal);
				},
				unbind: function() {
					console.log("unbind ...");
				}
			});
			
			//初始化Vue实例
			var vm = new Vue({
				el: "#app",
				data: {
					isExist: true,
					param: "first"
				}
			});
			
			//测试语句
			//vm.param = "second"; //触发update
			//vm.isExist = false; //触发unbind
		</script>
	</body>
</html>